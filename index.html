<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>The Equal Lens</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500;600&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box}

body{
  font-family:'Poppins',sans-serif;
  background:#0c0c0f;
  color:#fff;
}

/* ===== STORY SECTION ===== */
.story{
  height:100vh;
  position:relative;
  overflow:hidden;
}

/* TILE FIELD */
.tile-field{
  position:absolute;
  inset:0;
}

/* TILE */
.tile{
  position:absolute;
  width:140px;
  height:140px;
  background:#0c0c0f;
  border:1px solid rgba(255,255,255,0.18);
  display:flex;
  align-items:center;
  justify-content:center;
  text-align:center;
  padding:16px;
  font-family:"Playfair Display",serif;
  font-size:16px;
}

.tile span{
  opacity:0;
  transform:rotateY(90deg);
}

/* ACTIVE TILE */
.tile.active{
  border-color:#fff;
  box-shadow:0 0 30px rgba(255,255,255,0.15);
}
.tile.active span{
  opacity:1;
  transform:rotateY(0deg);
}

/* CENTER TEXT */
.center{
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  pointer-events:none;
}
.center-text{
  font-family:"Playfair Display",serif;
  font-size:36px;
  text-align:center;
  max-width:80%;
  opacity:0;
}

/* MOBILE */
@media(max-width:600px){
  .tile{
    width:110px;
    height:110px;
    font-size:14px;
  }
  .center-text{
    font-size:22px;
    max-width:90%;
  }
}
</style>
</head>

<body>

<section class="story">
  <div class="tile-field" id="tiles"></div>
  <div class="center">
    <div class="center-text" id="centerText"></div>
  </div>
</section>

<script src="https://cdn.jsdelivr.net/npm/gsap@3/dist/gsap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/gsap@3/dist/ScrollTrigger.min.js"></script>

<script>
gsap.registerPlugin(ScrollTrigger);

const messages = [
  "Kids don’t need a chapter on gender.",
  "They already know the rules.",
  "No one ever told them.",
  "They hear them at home.",
  "In classrooms.",
  "On playgrounds.",
  "Online."
];

const centerMessages = [
  "That silence teaches.",
  "WE DON’T LECTURE.",
  "WE HELP THEM NOTICE."
];

const isMobile = window.innerWidth < 600;

/* FIXED RANDOM POSITIONS (DON’T COLLAPSE ON MOBILE) */
const positionsDesktop = [
  {x:10,y:20},{x:60,y:15},{x:25,y:55},{x:70,y:60},
  {x:40,y:30},{x:15,y:70},{x:55,y:75},{x:80,y:40}
];

const positionsMobile = [
  {x:10,y:15},{x:60,y:18},{x:20,y:45},{x:55,y:50},
  {x:30,y:70},{x:65,y:72}
];

const positions = isMobile ? positionsMobile : positionsDesktop;

/* CREATE TILES */
const field = document.getElementById("tiles");
const tiles = positions.map(pos=>{
  const t = document.createElement("div");
  t.className = "tile";
  t.style.left = pos.x + "vw";
  t.style.top = pos.y + "vh";
  field.appendChild(t);
  return t;
});

/* SCROLL LENGTH — MUCH SLOWER ON MOBILE */
const scrollUnit = isMobile ? 600 : 420;

const tl = gsap.timeline({
  scrollTrigger:{
    trigger:".story",
    start:"top top",
    end:"+=" + (messages.length + centerMessages.length + 2) * scrollUnit,
    scrub:true,
    pin:true
  }
});

/* TILE STORY */
messages.forEach((text,i)=>{
  const tile = tiles[i % tiles.length];
  const span = document.createElement("span");
  span.textContent = text;
  tile.appendChild(span);

  tl.to({},{
    onStart:()=>{
      tiles.forEach(t=>{
        t.classList.remove("active");
        const s = t.querySelector("span");
        if(s) s.style.opacity = 0;
      });
      tile.classList.add("active");
      span.style.opacity = 1;
    }
  });
});

/* CLEAR ALL TILE TEXT COMPLETELY */
tl.to({},{
  onStart:()=>{
    tiles.forEach(t=>{
      const s = t.querySelector("span");
      if(s) s.remove();
      t.classList.remove("active");
    });
  }
});

/* CENTER TEXT */
const center = document.getElementById("centerText");
centerMessages.forEach(txt=>{
  tl.to(center,{
    onStart:()=>{
      center.textContent = txt;
      gsap.to(center,{opacity:1,duration:0.4});
    }
  })
  .to(center,{opacity:0,duration:0.4});
});
</script>

</body>
</html>
