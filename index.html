<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>The Equal Lens</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />

<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500;600&display=swap" rel="stylesheet">

<style>
/* RESET */
*{
  margin:0;
  padding:0;
  box-sizing:border-box;
}

body{
  background:#0b0b0e;
  color:#fff;
  font-family:'Playfair Display',serif;
  height:400vh;
}

/* STORY SECTION */
.story{
  height:100vh;
  position:relative;
}

/* FULL-SCREEN GRID */
.grid{
  position:fixed;
  inset:0;
  display:grid;
  grid-template-columns:repeat(6,1fr);
  grid-template-rows:repeat(6,1fr);
  background:#0b0b0e;
}

/* BIG SQUARE BOXES */
.cell{
  border:1.2px solid rgba(255,255,255,0.18);
  display:flex;
  align-items:center;
  justify-content:center;
  text-align:center;
  padding:26px;
  font-size:20px;
  line-height:1.4;
  transition:border-color .3s ease, box-shadow .3s ease;
}

/* HIDDEN TEXT */
.cell span{
  opacity:0;
  transition:opacity .4s ease;
}

/* ACTIVE BOX */
.cell.active{
  border-color:rgba(255,255,255,0.9);
  box-shadow:0 0 36px rgba(255,255,255,0.25);
  animation:spark .9s ease-out;
}

.cell.active span{
  opacity:1;
}

/* SUBTLE SPARK */
@keyframes spark{
  0%{box-shadow:0 0 0 rgba(255,255,255,0)}
  40%{box-shadow:0 0 38px rgba(255,255,255,0.35)}
  100%{box-shadow:0 0 28px rgba(255,255,255,0.22)}
}

/* CENTER TEXT */
.center{
  position:fixed;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  pointer-events:none;
}

.center-text{
  font-size:42px;
  opacity:0;
  text-align:center;
}

/* MOBILE */
@media(max-width:768px){
  .grid{
    grid-template-columns:repeat(4,1fr);
    grid-template-rows:repeat(6,1fr);
  }
  .cell{
    font-size:15px;
    padding:16px;
  }
  .center-text{
    font-size:24px;
  }
}
</style>
</head>

<body>

<section class="story">
  <div class="grid" id="grid"></div>
  <div class="center">
    <div class="center-text" id="centerText"></div>
  </div>
</section>

<script src="https://cdn.jsdelivr.net/npm/gsap@3/dist/gsap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/gsap@3/dist/ScrollTrigger.min.js"></script>

<script>
gsap.registerPlugin(ScrollTrigger);

/* EXACT STORY (NO FREESTYLE) */
const messages = [
  "Kids don’t learn gender in classrooms.",
  "They learn it in playgrounds.",
  "At home.",
  "In silence.",
  "Through jokes.",
  "Through rules no one explains."
];

const centerMessages = [
  "WE DON’T LECTURE.",
  "WE HELP THEM NOTICE."
];

const grid = document.getElementById("grid");

/* CREATE BIG GRID CELLS */
const cells = [];
const totalCells = window.innerWidth < 768 ? 24 : 36;

for(let i=0;i<totalCells;i++){
  const cell = document.createElement("div");
  cell.className = "cell";
  grid.appendChild(cell);
  cells.push(cell);
}

/* PRE-CHOSEN POSITIONS (LOOK BALANCED) */
const activeIndexesDesktop = [2, 8, 14, 21, 27, 32];
const activeIndexesMobile  = [1, 6, 11, 16, 20, 22];

const activeIndexes = window.innerWidth < 768
  ? activeIndexesMobile
  : activeIndexesDesktop;

/* TIMELINE */
const scrollUnit = window.innerWidth < 768 ? 700 : 550;

const tl = gsap.timeline({
  scrollTrigger:{
    trigger:".story",
    start:"top top",
    end:"+=" + (messages.length + centerMessages.length + 1) * scrollUnit,
    scrub:true,
    pin:true
  }
});

/* TEXT IN BOXES */
messages.forEach((text,i)=>{
  const cell = cells[activeIndexes[i]];
  const span = document.createElement("span");
  span.textContent = text;
  cell.appendChild(span);

  tl.to({},{
    onStart:()=>{
      cells.forEach(c=>{
        c.classList.remove("active");
        const s=c.querySelector("span");
        if(s) s.style.opacity=0;
      });
      cell.classList.add("active");
      span.style.opacity=1;
    }
  });
});

/* CLEAR GRID */
tl.to({},{
  onStart:()=>{
    cells.forEach(c=>{
      const s=c.querySelector("span");
      if(s) s.remove();
      c.classList.remove("active");
    });
  }
});

/* CENTER STATEMENT */
const center = document.getElementById("centerText");

centerMessages.forEach(txt=>{
  tl.to(center,{
    onStart:()=>{
      center.textContent = txt;
      gsap.to(center,{opacity:1,duration:.4});
    }
  }).to(center,{opacity:0,duration:.4});
});
</script>

</body>
</html>
